#use "topfind";;
#require "HamsterML";;
open HamsterML__Ast;;
open HamsterML__Lexer;;
open HamsterML__Parser;;
open HamsterML__Typing;;
let parse (s : string) : expr list =
  let lexbuf = Lexing.from_string s in
  let ast = HamsterML__Parser.prog HamsterML__Lexer.read lexbuf in
  ast
;;

let typecheck expr =
  let res = R.run (Infer.infer_expr TypeEnv.empty expr) in
  match res with
  | Ok (s, t) ->
    Subst.pp Format.std_formatter s;
    Format.fprintf Format.std_formatter "\n|> type: %s" (show_inf_type t)
  | Error e -> failwith (show_error e)
;;